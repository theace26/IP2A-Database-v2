# Phase 7 Sub-Phase Instruction Framework

**Sprint:** Week 31 — Work Package 3
**Spoke:** Spoke 2 (Operations)
**Source:** Hub guidance → Spoke 2 generation, February 5, 2026
**Purpose:** Pre-built instruction doc templates for Phase 7 sub-phases 7a through 7g
**For:** Claude Code execution when each sub-phase unblocks
**Output Location:** `docs/instructions/phase7/`

---

## How to Use This Document

This is a **master framework** containing the dependency chain and reference information for all 7 sub-phases of Phase 7 (Dispatch & Referral System). Each sub-phase has been extracted into its own standalone instruction document in this same directory.

### File Structure

```
docs/instructions/phase7/
├── Phase_7_Subphase_Instruction_Framework.md  ← THIS FILE (master reference)
├── Phase_7a_Data_Collection.md                ← BLOCKED (stub)
├── Phase_7b_Schema_Finalization.md            ← DETAILED (ready when 7a completes)
├── Phase_7c_Core_Services_API.md              ← Stub
├── Phase_7d_Import_Tooling.md                 ← Stub
├── Phase_7e_Frontend_UI.md                    ← Stub (Week 28 remaining items)
├── Phase_7f_Reports_P0_P1.md                  ← Stub
└── Phase_7g_Reports_P2_P3.md                  ← Stub
```

---

## Dependency Chain

```
    ┌──────────┐
    │   7a     │  Data Collection (⛔ BLOCKED — LaborPower access)
    │  3-5 hrs │
    └────┬─────┘
         │
    ┌────▼─────┐
    │   7b     │  Schema Finalization (DDL, Alembic, seed data)
    │ 10-15 hrs│
    └────┬─────┘
         │
    ┌────▼─────────────────────┐
    │         PARALLEL         │
    │  ┌──────┐   ┌──────┐    │
    │  │  7c  │   │  7d  │    │  7c: Core Services + API (25-35 hrs)
    │  │      │   │      │    │  7d: Import Tooling (15-20 hrs)
    │  └──┬───┘   └──────┘    │
    │     │                    │
    └─────┼────────────────────┘
          │
    ┌─────▼────┐
    │   7e     │  Frontend UI (remaining items from Week 28)
    │  5-8 hrs │  (Weeks 26-27 already complete — 28 routes, 11 pages, 15 partials)
    └────┬─────┘
         │
    ┌────▼─────┐
    │   7f     │  Reports P0 + P1 (49 reports)
    │ 20-30 hrs│
    └────┬─────┘
         │
    ┌────▼─────┐
    │   7g     │  Reports P2 + P3 (29 reports)
    │ 10-15 hrs│
    └──────────┘
```

### "READY WHEN" Conditions

| Sub-Phase | Ready When |
|-----------|------------|
| 7a | LaborPower system access granted (stakeholder approval) |
| 7b | 7a complete — Priority 1 data exports analyzed |
| 7c | 7b complete — Schema locked, migrations applied, seed data in place |
| 7d | 7b complete — Can run parallel with 7c |
| 7e | 7c complete — Services and API available for frontend to consume |
| 7f | 7c complete — Services available for report generation |
| 7g | 7f complete — P0+P1 report patterns established |

---

## Key Reference Documents

| Document | Location | Purpose |
|----------|----------|---------|
| Consolidated Continuity Doc | `docs/phase7/UnionCore_Continuity_Document_Consolidated.md` | Master reference — all findings merged |
| Implementation Plan v2 | `docs/phase7/PHASE7_IMPLEMENTATION_PLAN_v2.md` | Technical details, corrected data model |
| Local 46 Referral Books | `docs/phase7/LOCAL46_REFERRAL_BOOKS.md` | Book definitions and seed data |
| LaborPower Gap Analysis | `docs/phase7/LABORPOWER_GAP_ANALYSIS.md` | What LaborPower has vs what we need |
| Reports Inventory | `docs/phase7/LABORPOWER_REFERRAL_REPORTS_INVENTORY.md` | 78 reports by priority tier |
| ADR-015 | `docs/decisions/ADR-015-phase7-foundation.md` | Phase 7 schema and service decisions |
| ADR-016 | `docs/decisions/ADR-016-phase7-frontend-ui-patterns.md` | Frontend patterns (Weeks 26-27) |
| CLAUDE.md | `CLAUDE.md` (repo root) | Current project state |

### Critical Schema Reminders (Apply to ALL Sub-Phases)

1. **APN = DECIMAL(10,2)** — integer part is Excel serial date, decimal is secondary sort key. NEVER truncate.
2. **Duplicate APNs exist** — unique constraint: `UNIQUE(member_id, book_id, book_priority_number)`
3. **Member ≠ Student** — separate entities, separate lifecycles. Dispatch uses Members.
4. **Book Name ≠ Contract Code** — STOCKMAN → STOCKPERSON. 3 books have NO contract.
5. **RESIDENTIAL = 8th contract code** — 259 employers, 52 residential-only.
6. **11 known books** — includes TERO APPR WIRE (compound) and 3 regional Wire books.
7. **14 business rules** from Oct 2024 Referral Procedures govern all dispatch logic.

---

## Version History

| Date | Changes |
|------|---------|
| February 5, 2026 | Initial framework created (Week 31 WP3). 7b fully detailed. All others as stubs. |

---

**End of Framework Document**
*Generated by Spoke 2 — February 5, 2026*
*For deployment via Claude Code*
