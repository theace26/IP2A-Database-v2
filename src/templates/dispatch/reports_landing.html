{% extends "base.html" %}

{% block title %}Dispatch Reports{% endblock %}

{% block content %}
<div class="flex justify-between items-center mb-6">
    <div>
        <h1 class="text-2xl font-bold">Dispatch Reports</h1>
        <p class="text-base-content/60">Generate operational reports for referral and dispatch</p>
    </div>
</div>

<!-- Summary Stats -->
<div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
    <div class="stat bg-base-100 rounded-lg shadow-sm border border-base-300">
        <div class="stat-title">Total Reports</div>
        <div class="stat-value text-primary">{{ total_reports }}</div>
        <div class="stat-desc">Across all categories</div>
    </div>

    <div class="stat bg-base-100 rounded-lg shadow-sm border border-base-300">
        <div class="stat-title">Available Now</div>
        <div class="stat-value text-success">{{ available_reports }}</div>
        <div class="stat-desc">Ready to generate</div>
    </div>

    <div class="stat bg-base-100 rounded-lg shadow-sm border border-base-300">
        <div class="stat-title">Coming Soon</div>
        <div class="stat-value text-base-content/40">{{ total_reports - available_reports }}</div>
        <div class="stat-desc">In development</div>
    </div>
</div>

<!-- Report Categories Grid -->
<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
    {% for category in categories %}
    <div class="card bg-base-100 shadow-md">
        <div class="card-body">
            <div class="flex items-start justify-between">
                <div class="flex items-center gap-3">
                    <!-- Icon placeholder -->
                    <div class="w-10 h-10 rounded-lg bg-primary/10 flex items-center justify-center">
                        {% if category.icon == 'clipboard-list' %}
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" />
                        </svg>
                        {% elif category.icon == 'truck' %}
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4" />
                        </svg>
                        {% elif category.icon == 'user-plus' %}
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z" />
                        </svg>
                        {% elif category.icon == 'office-building' %}
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                        </svg>
                        {% elif category.icon == 'shield-check' %}
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
                        </svg>
                        {% elif category.icon == 'user' %}
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                        </svg>
                        {% elif category.icon == 'chart-bar' %}
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                        </svg>
                        {% elif category.icon == 'calculator' %}
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
                        </svg>
                        {% else %}
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                        </svg>
                        {% endif %}
                    </div>
                    <div>
                        <h2 class="card-title text-lg">{{ category.name }}</h2>
                        <span class="badge badge-sm badge-outline">{{ category.priority }}</span>
                    </div>
                </div>
            </div>

            <p class="text-sm text-base-content/60 mt-2">{{ category.description }}</p>

            <!-- Progress bar -->
            <div class="mt-3">
                <div class="flex justify-between text-sm mb-1">
                    <span>{{ category.available_count }} of {{ category.total }} available</span>
                    <span>{{ ((category.available_count / category.total) * 100) | round | int }}%</span>
                </div>
                <progress
                    class="progress progress-primary"
                    value="{{ category.available_count }}"
                    max="{{ category.total }}"
                ></progress>
            </div>

            <!-- Report list -->
            <div class="mt-4 space-y-2">
                {% for report in category.reports %}
                <div class="flex items-center justify-between p-2 rounded-lg hover:bg-base-200">
                    <div class="flex items-center gap-2">
                        {% if report.available %}
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-success" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                        </svg>
                        <span>{{ report.name }}</span>
                        {% else %}
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-base-content/30" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                        </svg>
                        <span class="text-base-content/40">{{ report.name }}</span>
                        {% endif %}
                    </div>
                    {% if report.available %}
                    <a href="{{ report.url }}" class="btn btn-xs btn-primary">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                        </svg>
                        Download
                    </a>
                    {% else %}
                    <span class="text-xs text-base-content/30">Coming Soon</span>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
    {% endfor %}
</div>

<!-- Info Alert -->
<div class="alert alert-info mt-6">
    <svg xmlns="http://www.w3.org/2000/svg" class="stroke-current flex-shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
    </svg>
    <span>Reports are generated on-demand. Large reports may take a few seconds to generate.</span>
</div>
{% endblock %}
