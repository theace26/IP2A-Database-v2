{# Grievances table with sortable headers #}
{% from 'components/_sortable_th.html' import sortable_header %}

<div class="overflow-x-auto">
    <table class="table table-zebra">
        <thead>
            <tr class="bg-base-200">
                <th class="sticky top-32 z-10 bg-base-200">Grievance #</th>
                <th class="sticky top-32 z-10 bg-base-200">Member</th>
                <th class="sticky top-32 z-10 bg-base-200">Employer</th>
                <th class="sticky top-32 z-10 bg-base-200">Step Progress</th>
                {{ sortable_header('status', 'Status', current_sort, current_order, extra_params="[name='q'], [name='status'], [name='step'], [name='page']") }}
                {{ sortable_header('filed_date', 'Filed', current_sort, current_order, extra_params="[name='q'], [name='status'], [name='step'], [name='page']") }}
                <th class="sticky top-32 z-10 bg-base-200 w-24">Actions</th>
            </tr>
        </thead>
        <tbody id="table-body">
            {% include 'operations/grievances/partials/_table_body.html' %}
        </tbody>
    </table>
</div>

{% if grievances %}
<!-- Pagination -->
<div class="flex flex-col sm:flex-row items-center justify-between gap-4 p-4 border-t border-base-200">
    <div class="text-sm text-base-content/60">
        Showing {{ ((current_page - 1) * 20) + 1 }} - {{ ((current_page - 1) * 20) + grievances|length }} of {{ total }}
    </div>

    <div class="join">
        {% if current_page > 1 %}
        <button
            class="join-item btn btn-sm"
            hx-get="/operations/grievances/search?page={{ current_page - 1 }}&q={{ query }}&status={{ status_filter }}&step={{ step_filter }}&sort={{ current_sort }}&order={{ current_order }}"
            hx-target="#table-container"
        >Previous</button>
        {% else %}
        <button class="join-item btn btn-sm btn-disabled">Previous</button>
        {% endif %}

        <button class="join-item btn btn-sm btn-active">{{ current_page }}</button>

        {% if current_page < total_pages %}
        <button
            class="join-item btn btn-sm"
            hx-get="/operations/grievances/search?page={{ current_page + 1 }}&q={{ query }}&status={{ status_filter }}&step={{ step_filter }}&sort={{ current_sort }}&order={{ current_order }}"
            hx-target="#table-container"
        >Next</button>
        {% else %}
        <button class="join-item btn btn-sm btn-disabled">Next</button>
        {% endif %}
    </div>
</div>
{% endif %}
