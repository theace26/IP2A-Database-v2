{% extends "base.html" %}

{% block title %}Activity {{ activity.id }} - SALTing - IP2A{% endblock %}

{% block content %}
<div class="space-y-6">
    <!-- Breadcrumb -->
    <div class="text-sm breadcrumbs">
        <ul>
            <li><a href="/dashboard">Dashboard</a></li>
            <li><a href="/operations">Operations</a></li>
            <li><a href="/operations/salting">SALTing</a></li>
            <li>Activity #{{ activity.id }}</li>
        </ul>
    </div>

    <!-- Page Header -->
    <div class="flex flex-col lg:flex-row lg:items-start lg:justify-between gap-4">
        <div>
            <div class="flex items-center gap-3">
                <h1 class="text-2xl font-bold">SALTing Activity #{{ activity.id }}</h1>
                <span class="badge {{ get_type_badge_class(activity.activity_type) }} badge-lg">
                    {{ activity.activity_type.value.replace('_', ' ') | title }}
                </span>
                {% if activity.outcome %}
                <span class="badge {{ get_outcome_badge_class(activity.outcome) }} badge-lg">
                    {{ activity.outcome.value.replace('_', ' ') | title }}
                </span>
                {% endif %}
            </div>
            <p class="text-base-content/60 mt-1">
                {{ activity.activity_date.strftime('%B %d, %Y') if activity.activity_date else 'Date unknown' }}
            </p>
        </div>
        <div class="flex gap-2">
            <a href="/operations/salting" class="btn btn-ghost">Back to List</a>
            <button class="btn btn-primary">Edit Activity</button>
        </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <!-- Main Content -->
        <div class="lg:col-span-2 space-y-6">
            <!-- Activity Details -->
            <div class="card bg-base-100 shadow">
                <div class="card-body">
                    <h2 class="card-title">Activity Details</h2>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                        <div>
                            <label class="text-sm text-base-content/60">Activity Type</label>
                            <p>
                                <span class="badge {{ get_type_badge_class(activity.activity_type) }}">
                                    {{ activity.activity_type.value.replace('_', ' ') | title }}
                                </span>
                            </p>
                        </div>
                        <div>
                            <label class="text-sm text-base-content/60">Outcome</label>
                            <p>
                                {% if activity.outcome %}
                                <span class="badge {{ get_outcome_badge_class(activity.outcome) }}">
                                    {{ activity.outcome.value.replace('_', ' ') | title }}
                                </span>
                                {% else %}
                                <span class="text-base-content/40">Not recorded</span>
                                {% endif %}
                            </p>
                        </div>
                        <div>
                            <label class="text-sm text-base-content/60">Workers Contacted</label>
                            <p class="font-bold text-lg">{{ activity.workers_contacted or 0 }}</p>
                        </div>
                        <div>
                            <label class="text-sm text-base-content/60">Cards Signed</label>
                            <p class="font-bold text-lg {{ 'text-success' if activity.cards_signed and activity.cards_signed > 0 else '' }}">
                                {{ activity.cards_signed or 0 }}
                            </p>
                        </div>
                    </div>

                    {% if activity.location %}
                    <div class="mt-4">
                        <label class="text-sm text-base-content/60">Location</label>
                        <p class="font-medium">{{ activity.location }}</p>
                    </div>
                    {% endif %}

                    {% if activity.description %}
                    <div class="mt-4">
                        <label class="text-sm text-base-content/60">Description</label>
                        <div class="bg-base-200 p-4 rounded-lg mt-1 whitespace-pre-wrap">{{ activity.description }}</div>
                    </div>
                    {% endif %}

                    {% if activity.notes %}
                    <div class="mt-4">
                        <label class="text-sm text-base-content/60">Notes</label>
                        <div class="bg-base-200 p-4 rounded-lg mt-1 whitespace-pre-wrap">{{ activity.notes }}</div>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Sidebar -->
        <div class="space-y-6">
            <!-- Organizer Info -->
            <div class="card bg-base-100 shadow">
                <div class="card-body">
                    <h2 class="card-title text-lg">Organizer</h2>
                    {% if activity.member %}
                    <div class="flex items-center gap-3 mt-2">
                        <div class="avatar placeholder">
                            <div class="bg-primary text-primary-content rounded-full w-12">
                                <span>{{ activity.member.first_name[0] | upper }}{{ activity.member.last_name[0] | upper }}</span>
                            </div>
                        </div>
                        <div>
                            <p class="font-medium">{{ activity.member.first_name }} {{ activity.member.last_name }}</p>
                            {% if activity.member.email %}
                            <p class="text-sm text-base-content/60">{{ activity.member.email }}</p>
                            {% endif %}
                        </div>
                    </div>
                    <a href="/members/{{ activity.member.id }}" class="btn btn-outline btn-sm mt-3">View Profile</a>
                    {% else %}
                    <p class="text-base-content/50">No organizer assigned</p>
                    {% endif %}
                </div>
            </div>

            <!-- Target Employer -->
            <div class="card bg-base-100 shadow">
                <div class="card-body">
                    <h2 class="card-title text-lg">Target Employer</h2>
                    {% if activity.organization %}
                    <div class="mt-2">
                        <p class="font-medium text-lg">{{ activity.organization.name }}</p>
                        {% if activity.organization.address %}
                        <p class="text-sm text-base-content/60 mt-1">{{ activity.organization.address }}</p>
                        {% endif %}
                    </div>
                    {% else %}
                    <p class="text-base-content/50">No employer assigned</p>
                    {% endif %}
                </div>
            </div>

            <!-- Timeline -->
            <div class="card bg-base-100 shadow">
                <div class="card-body">
                    <h2 class="card-title text-lg">Timeline</h2>
                    <div class="space-y-3 text-sm mt-2">
                        <div class="flex justify-between">
                            <span class="text-base-content/60">Activity Date</span>
                            <span>{{ activity.activity_date.strftime('%b %d, %Y') if activity.activity_date else '—' }}</span>
                        </div>
                        <div class="divider my-2"></div>
                        <div class="flex justify-between">
                            <span class="text-base-content/60">Created</span>
                            <span>{{ activity.created_at.strftime('%b %d, %Y') if activity.created_at else '—' }}</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-base-content/60">Updated</span>
                            <span>{{ activity.updated_at.strftime('%b %d, %Y') if activity.updated_at else '—' }}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
