{# SALTing activities table with sortable headers #}
{% from 'components/_sortable_th.html' import sortable_header %}

<div class="overflow-x-auto">
    <table class="table table-zebra table-pin-rows">
        <thead>
            <tr class="bg-base-200">
                {{ sortable_header('activity_date', 'Date', current_sort, current_order, extra_params="[name='q'], [name='activity_type'], [name='outcome'], [name='page']") }}
                {{ sortable_header('member_id', 'Organizer', current_sort, current_order, extra_params="[name='q'], [name='activity_type'], [name='outcome'], [name='page']") }}
                {{ sortable_header('organization_id', 'Employer', current_sort, current_order, extra_params="[name='q'], [name='activity_type'], [name='outcome'], [name='page']") }}
                {{ sortable_header('activity_type', 'Type', current_sort, current_order, extra_params="[name='q'], [name='activity_type'], [name='outcome'], [name='page']") }}
                {{ sortable_header('workers_contacted', 'Workers', current_sort, current_order, extra_params="[name='q'], [name='activity_type'], [name='outcome'], [name='page']") }}
                {{ sortable_header('cards_signed', 'Cards', current_sort, current_order, extra_params="[name='q'], [name='activity_type'], [name='outcome'], [name='page']") }}
                {{ sortable_header('outcome', 'Outcome', current_sort, current_order, extra_params="[name='q'], [name='activity_type'], [name='outcome'], [name='page']") }}
                <th class="bg-base-200 w-24">Actions</th>
            </tr>
        </thead>
        <tbody id="table-body">
            {% include 'operations/salting/partials/_table_body.html' %}
        </tbody>
    </table>
</div>

{% if activities %}
<!-- Pagination -->
<div class="flex flex-col sm:flex-row items-center justify-between gap-4 p-4 border-t border-base-200">
    <div class="text-sm text-base-content/60">
        Showing {{ ((current_page - 1) * 20) + 1 }} - {{ ((current_page - 1) * 20) + activities|length }} of {{ total }}
    </div>

    <div class="join">
        {% if current_page > 1 %}
        <button
            class="join-item btn btn-sm"
            hx-get="/operations/salting/search?page={{ current_page - 1 }}&q={{ query }}&activity_type={{ type_filter }}&outcome={{ outcome_filter }}&sort={{ current_sort }}&order={{ current_order }}"
            hx-target="#table-container"
        >Previous</button>
        {% else %}
        <button class="join-item btn btn-sm btn-disabled">Previous</button>
        {% endif %}

        <button class="join-item btn btn-sm btn-active">{{ current_page }}</button>

        {% if current_page < total_pages %}
        <button
            class="join-item btn btn-sm"
            hx-get="/operations/salting/search?page={{ current_page + 1 }}&q={{ query }}&activity_type={{ type_filter }}&outcome={{ outcome_filter }}&sort={{ current_sort }}&order={{ current_order }}"
            hx-target="#table-container"
        >Next</button>
        {% else %}
        <button class="join-item btn btn-sm btn-disabled">Next</button>
        {% endif %}
    </div>
</div>
{% endif %}
