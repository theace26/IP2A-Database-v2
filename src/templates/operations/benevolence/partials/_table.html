{# Benevolence applications table with sortable headers #}
{% from 'components/_sortable_th.html' import sortable_header %}

<div>
    <table class="table table-zebra table-pin-rows">
        <thead>
            <tr class="bg-base-200">
                {{ sortable_header('application_date', 'Date', current_sort, current_order, extra_params="[name='q'], [name='status'], [name='reason'], [name='page']") }}
                <th class="bg-base-200">Member</th>
                {{ sortable_header('reason', 'Reason', current_sort, current_order, extra_params="[name='q'], [name='status'], [name='reason'], [name='page']") }}
                {{ sortable_header('amount_requested', 'Requested', current_sort, current_order, extra_params="[name='q'], [name='status'], [name='reason'], [name='page']") }}
                <th class="bg-base-200">Approved</th>
                {{ sortable_header('status', 'Status', current_sort, current_order, extra_params="[name='q'], [name='status'], [name='reason'], [name='page']") }}
                <th class="bg-base-200 w-24">Actions</th>
            </tr>
        </thead>
        <tbody id="table-body">
            {% include 'operations/benevolence/partials/_table_body.html' %}
        </tbody>
    </table>
</div>

{% if applications %}
<!-- Pagination -->
<div class="flex flex-col sm:flex-row items-center justify-between gap-4 p-4 border-t border-base-200">
    <div class="text-sm text-base-content/60">
        Showing {{ ((current_page - 1) * 20) + 1 }} - {{ ((current_page - 1) * 20) + applications|length }} of {{ total }}
    </div>

    <div class="join">
        {% if current_page > 1 %}
        <button
            class="join-item btn btn-sm"
            hx-get="/operations/benevolence/search?page={{ current_page - 1 }}&q={{ query }}&status={{ status_filter }}&reason={{ reason_filter }}&sort={{ current_sort }}&order={{ current_order }}"
            hx-target="#table-container"
        >Previous</button>
        {% else %}
        <button class="join-item btn btn-sm btn-disabled">Previous</button>
        {% endif %}

        <button class="join-item btn btn-sm btn-active">{{ current_page }}</button>

        {% if current_page < total_pages %}
        <button
            class="join-item btn btn-sm"
            hx-get="/operations/benevolence/search?page={{ current_page + 1 }}&q={{ query }}&status={{ status_filter }}&reason={{ reason_filter }}&sort={{ current_sort }}&order={{ current_order }}"
            hx-target="#table-container"
        >Next</button>
        {% else %}
        <button class="join-item btn btn-sm btn-disabled">Next</button>
        {% endif %}
    </div>
</div>
{% endif %}
