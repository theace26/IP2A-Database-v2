{% extends "base.html" %}

{% block title %}{{ student.member.first_name }} {{ student.member.last_name }} - Students - IP2A{% endblock %}

{% block content %}
<div class="space-y-6">
    <!-- Breadcrumb -->
    <div class="text-sm breadcrumbs">
        <ul>
            <li><a href="/dashboard">Dashboard</a></li>
            <li><a href="/training">Training</a></li>
            <li><a href="/training/students">Students</a></li>
            <li>{{ student.member.first_name }} {{ student.member.last_name }}</li>
        </ul>
    </div>

    <!-- Page Header -->
    <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
        <div class="flex items-center gap-4">
            <div class="avatar placeholder">
                <div class="bg-neutral text-neutral-content rounded-full w-16">
                    <span class="text-xl">
                        {{ student.member.first_name[0] | upper }}{{ student.member.last_name[0] | upper }}
                    </span>
                </div>
            </div>
            <div>
                <h1 class="text-2xl font-bold">{{ student.member.first_name }} {{ student.member.last_name }}</h1>
                <p class="text-base-content/60">{{ student.student_number }}</p>
            </div>
        </div>
        <span class="badge {{ get_status_badge(student.status) }} badge-lg">
            {{ student.status.value | replace('_', ' ') | title }}
        </span>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <!-- Main Info -->
        <div class="lg:col-span-2 space-y-6">
            <!-- Contact Info -->
            <div class="card bg-base-100 shadow">
                <div class="card-body">
                    <h2 class="card-title">Contact Information</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="label"><span class="label-text text-base-content/60">Email</span></label>
                            <p class="font-medium">{{ student.member.email }}</p>
                        </div>
                        <div>
                            <label class="label"><span class="label-text text-base-content/60">Phone</span></label>
                            <p class="font-medium">{{ student.member.phone or 'Not provided' }}</p>
                        </div>
                        <div>
                            <label class="label"><span class="label-text text-base-content/60">Cohort</span></label>
                            <p class="font-medium">{{ student.cohort or 'None' }}</p>
                        </div>
                        <div>
                            <label class="label"><span class="label-text text-base-content/60">Status</span></label>
                            <p class="font-medium">
                                <span class="badge {{ get_status_badge(student.status) }}">
                                    {{ student.status.value | replace('_', ' ') | title }}
                                </span>
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Enrollments -->
            <div class="card bg-base-100 shadow">
                <div class="card-body">
                    <h2 class="card-title">Course Enrollments</h2>
                    {% if student.enrollments %}
                    <div class="overflow-x-auto">
                        <table class="table table-sm">
                            <thead>
                                <tr>
                                    <th>Course</th>
                                    <th>Status</th>
                                    <th>Grade</th>
                                    <th>Enrolled</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for enrollment in student.enrollments %}
                                <tr>
                                    <td>
                                        <div class="font-medium">{{ enrollment.course.code }}</div>
                                        <div class="text-sm text-base-content/60">{{ enrollment.course.name }}</div>
                                    </td>
                                    <td>
                                        <span class="badge {{ get_enrollment_badge(enrollment.status) }} badge-sm">
                                            {{ enrollment.status.value | title }}
                                        </span>
                                    </td>
                                    <td>{{ enrollment.letter_grade or enrollment.final_grade or '-' }}</td>
                                    <td>{{ enrollment.enrollment_date.strftime('%b %d, %Y') }}</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    {% else %}
                    <p class="text-base-content/50 text-center py-4">No course enrollments</p>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Sidebar -->
        <div class="space-y-6">
            <!-- Program Dates -->
            <div class="card bg-base-100 shadow">
                <div class="card-body">
                    <h2 class="card-title">Program Dates</h2>
                    <div class="space-y-3">
                        <div>
                            <label class="label"><span class="label-text text-base-content/60">Application Date</span></label>
                            <p class="font-medium">{{ student.application_date.strftime('%B %d, %Y') }}</p>
                        </div>
                        {% if student.enrollment_date %}
                        <div>
                            <label class="label"><span class="label-text text-base-content/60">Enrolled</span></label>
                            <p class="font-medium">{{ student.enrollment_date.strftime('%B %d, %Y') }}</p>
                        </div>
                        {% endif %}
                        <div>
                            <label class="label"><span class="label-text text-base-content/60">Expected Completion</span></label>
                            <p class="font-medium">
                                {% if student.expected_completion_date %}
                                {{ student.expected_completion_date.strftime('%B %d, %Y') }}
                                {% else %}
                                Not set
                                {% endif %}
                            </p>
                        </div>
                        {% if student.actual_completion_date %}
                        <div>
                            <label class="label"><span class="label-text text-base-content/60">Completed</span></label>
                            <p class="font-medium text-success">{{ student.actual_completion_date.strftime('%B %d, %Y') }}</p>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>

            <!-- Emergency Contact -->
            {% if student.emergency_contact_name %}
            <div class="card bg-base-100 shadow">
                <div class="card-body">
                    <h2 class="card-title">Emergency Contact</h2>
                    <div class="space-y-2">
                        <p class="font-medium">{{ student.emergency_contact_name }}</p>
                        {% if student.emergency_contact_relationship %}
                        <p class="text-sm text-base-content/60">{{ student.emergency_contact_relationship }}</p>
                        {% endif %}
                        {% if student.emergency_contact_phone %}
                        <p class="text-sm">{{ student.emergency_contact_phone }}</p>
                        {% endif %}
                    </div>
                </div>
            </div>
            {% endif %}

            <!-- Notes -->
            {% if student.notes %}
            <div class="card bg-base-100 shadow">
                <div class="card-body">
                    <h2 class="card-title">Notes</h2>
                    <p class="text-sm whitespace-pre-wrap">{{ student.notes }}</p>
                </div>
            </div>
            {% endif %}

            <!-- Actions -->
            <div class="card bg-base-100 shadow">
                <div class="card-body">
                    <h2 class="card-title">Actions</h2>
                    <div class="space-y-2">
                        <button class="btn btn-outline btn-block btn-disabled" title="Coming soon">
                            Edit Student
                        </button>
                        <button class="btn btn-outline btn-block btn-disabled" title="Coming soon">
                            Enroll in Course
                        </button>
                        <a href="/training/students" class="btn btn-ghost btn-block">
                            Back to Students
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
